# Alatar SDDM Configuration

This directory contains the SDDM (Simple Desktop Display Manager) configuration for the Alatar system.

## Features

- **Alatar Theme**: Custom theme using the Ancient font
- **Wallust Integration**: Dynamic colors from your wallpaper
- **Sway Default**: Automatically selects Sway as the default session
- **Wallpaper Background**: Uses the system wallpaper as the login screen background

## Requirements

The Alatar SDDM theme is built with Qt6 and requires:
- `sddm-qt6` - Qt6 version of SDDM
- `sddm-greeter-qt6` - Qt6 greeter for SDDM themes
- `qt6-declarative-imports` - Qt6 QML imports (QtQuick, QtQuick.Controls)

These are included in the Alatar `prelude` package:
```bash
./bin2/alatar.tcl package install prelude
```

Or install manually:
```bash
sudo zypper install sddm-qt6 sddm-greeter-qt6 qt6-declarative-imports
```

## Installation

SDDM configuration requires root access as it modifies system files.

### Quick Install

Use the alatar CLI:

```bash
~/.alatar/bin2/alatar.tcl sddm install
```

Or run the installation script directly:

```bash
sudo ~/.alatar/alatar_dots/sddm/install.sh
```

This will install the theme, configuration, and create the wallpaper symlink.

### Manual Installation

If you prefer to install manually:

#### 1. Install the theme

```bash
sudo mkdir -p /usr/share/sddm/themes/alatar
sudo cp -r ~/.alatar/alatar_dots/sddm/alatar-theme/* /usr/share/sddm/themes/alatar/
```

### 2. Install the SDDM configuration

```bash
sudo cp ~/.alatar/alatar_dots/sddm/sddm.conf /etc/sddm.conf
```

### 3. Create wallpaper directory and symlink

The theme expects the wallpaper at `/usr/share/wallpapers/alatar/wallpaper.png`:

```bash
sudo mkdir -p /usr/share/wallpapers/alatar
sudo ln -sf ~/.config/wallpaper.png /usr/share/wallpapers/alatar/wallpaper.png
```

**Note**: This creates a symlink to your user's wallpaper. When you change wallpapers using `pape.sh`, the SDDM login screen will automatically use the new wallpaper.

### 4. Generate initial theme colors

Run wallust to generate the theme.conf with current colors:

```bash
wallust run ~/.config/wallpaper.png
```

Then copy the generated theme.conf to the system:

```bash
sudo cp ~/.alatar/alatar_dots/sddm/alatar-theme/theme.conf /usr/share/sddm/themes/alatar/theme.conf
```

### 5. Restart SDDM

```bash
sudo systemctl restart sddm
```

## Updating Colors

When you change your wallpaper using `pape.sh`, the SDDM theme colors will automatically update:

1. `pape.sh` runs `wallust run` which regenerates `theme.conf`
2. The wallpaper symlink at `/usr/share/wallpapers/alatar/wallpaper.png` points to your new wallpaper
3. **Automatic**: `pape.sh` automatically copies the new theme.conf to `/usr/share/sddm/themes/alatar/`
4. Changes take effect on next login (or restart SDDM: `sudo systemctl restart sddm`)

**Manual update** (if needed):
```bash
~/.alatar/bin2/alatar.tcl sddm update-theme
```

## Configuration

- **Theme**: `alatar-theme/` - QML-based SDDM theme
- **Config**: `sddm.conf` - SDDM daemon configuration
- **Default Session**: Sway (automatically selected in the QML code)
- **Font**: Ancient (make sure it's installed in /usr/share/fonts or ~/.fonts)

## Files

- `alatar-theme/Main.qml` - Main UI code
- `alatar-theme/theme.conf` - Generated by wallust (colors)
- `alatar-theme/metadata.desktop` - Theme metadata
- `sddm.conf` - SDDM system configuration
- `wallust/templates/sddm-theme.conf` - Wallust template for theme.conf

## Troubleshooting

- **Font not showing**: Ensure Ancient font is installed system-wide in `/usr/share/fonts`
- **Wallpaper not loading**: Check that `/usr/share/wallpapers/alatar/wallpaper.png` exists and is readable
- **Sway not default**: The QML code searches for "sway" in the session list and selects it automatically
- **Colors wrong**: Run `wallust run` and copy the generated theme.conf to the system location
